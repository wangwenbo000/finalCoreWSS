
<%=include adminheader_index.html%>
<h1 class="page-header"><span class="glyphicon glyphicon-qrcode" aria-hidden="true"></span> 产品管理 <small>一周早餐管理</small></h1>
<div class="row">
    <div class="col-sm-3" id="productlist" v-repeat="product:products">
        <div class="panel panel-default">
            <!-- Default panel contents -->
            <div class="panel-heading morningFoodDays"><h4>星期{{product.days}} <small>{{product.updatetime}}</small></h4></div>

            <!-- Table -->
            <table class="table table-bordered">
                <thead>
                <tr>
                    <th>id：{{product.id}}</th>
                    <th colspan="2">图片</th>
                    <th>成本</th>
                    <th>单价</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><img src="/resource/img/food/b0.jpg" alt="..." width="66" ></td>
                    <td colspan="2">{{product.productName}}</td>
                    <td><h4>￥{{product.cost}}</h4></td>
                    <td><h3 class="text-danger">￥{{product.price}}</h3></td>
                </tr>
                <tr>
                    <th colspan="2">创建时间</th>
                    <th colspan="2">活动</th>
                    <th rowspan="2">
                        <a href="#" class="btn btn-success btn-block" data-toggle="modal" data-target=".bs-example-modal-sm" data-day="星期{{product.days}}" data-id="{{product.id}}" role="button">更新</a>
                    </th>
                </tr>
                <tr>
                    <td colspan="2"></td>
                    <td class="text-success warning" colspan="2">
                        <h5>活动促销A</h5>
                    </td>
                </tr>
                </tbody>
            </table>
            <div class="panel-body">
                <blockquote>
                    <p>{{product.describe}}</p>
                    <footer>{{product.updatetime}} <cite title="Source Title">Source Title</cite></footer>
                </blockquote>

            </div>
        </div>
    </div>
</div>

<div class="modal fade bs-example-modal-sm" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="exampleModalLabel">编辑当日早餐信息</h4>
            </div>
            <div class="modal-body">
                <form id="updateFoodInfo">
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <span class="glyphicon glyphicon-cloud-upload" aria-hidden="true"></span> 图片拖拽上传
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="recipient-name" class="control-label">早餐名:</label>
                        <input type="text" class="form-control" id="recipient-name" v-model="productName">
                    </div>
                    <div class="form-group">
                        <label for="recipient-name" class="control-label">成本</label>
                        <input type="text" class="form-control" id="recipient-name" v-model="cost">
                    </div>
                    <div class="form-group">
                        <label for="recipient-name" class="control-label">单价</label>
                        <input type="text" class="form-control" id="recipient-name" v-model="price">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputEmail2" class="control-label">活动</label>
                        <select class="form-control" v-model="sex" id="exampleInputEmail2">
                            <option value="*">性别</option>
                            <option value="1">boy</option>
                            <option value="0">girl</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="message-text" class="control-label">Message:</label>
                        <textarea class="form-control" id="message-text" v-model="describe" rows="6"></textarea>
                    </div>
                    <div class="form-group">
                        <button type="button" class="btn btn-primary btn-lg btn-block">更新数据</button>
                    </div>
                    {{$data | json 2}}
                </form>
            </div>
        </div>
    </div>
</div>
<script>
    var productList = new Vue({
        el:'#productlist',
        data:{products:<%- JSON.stringify(productList) %>}
    });
    var uploadProductInfo = new Vue({
        el:'#updateFoodInfo',
        data:{
            name:'hi'
        }
    })
    $('#exampleModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget);
        var productId = button.data('id');
        var whichDay = button.data('day');
        $(this).find('.modal-title').text('更新\"'+whichDay+'\"的早餐');

        Messenger().run({
            successMessage: '正在请求 ['+whichDay+'] 早餐数据',
            errorMessage: 'Error saving data',
            progressMessage: '正在处理数据',
        },{
            url: '/Admin/Product/getinfobyid',
            type:'post',
            data:{'id':productId},
            success:function(data){
                uploadProductInfo.$data = JSON.parse(data)[0];
                Messenger().post('数据请求完成');
            }
        });
    })
</script>
<%=include adminfooter_index.html%>