<%=include adminheader_index.html%>
<style media="screen">
  #mapContainer{
    height: 560px;
  }
</style>
<h4 class="page-header">
  <span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span> 早安控制台
  <small>整站统计监测信息</small>
</h4>
<div class="statecount page-header clearfix">
  <div class="col-xs-3 ">
    <h5>配送区域地图</h5>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <div id="mapContainer" ></div>
</div>
</div>
<script type="text/javascript">
    //初始化地图对象，加载地图
    var map = new AMap.Map("mapContainer", {
        resizeEnable: true,
            center: [116.464405,39.984006],//地图中心点
            zoom: 17 //地图显示的缩放级别
        });
         map.setMapStyle('light');
         var buildings = new AMap.Buildings();
         // 在map中添加3D楼块图层
         buildings.setMap(map);
         addCloudLayer();

    //叠加云数据图层
    function addCloudLayer() {
        //加载云图层插件
        map.plugin('AMap.CloudDataLayer', function() {
            var layerOptions = {
                query: {keywords: ''},
                clickable: true
            };
            var cloudDataLayer = new AMap.CloudDataLayer('5588fe0be4b062df8bcd62da', layerOptions); //实例化云图层类
            cloudDataLayer.setMap(map); //叠加云图层到地图

            AMap.event.addListener(cloudDataLayer, 'click', function(result) {
                var clouddata = result.data;
                var photo=[];
                if(clouddata._image[0]){//如果有上传的图片
                    photo=['<img width=240 height=100 src="'+clouddata._image[0]._preurl+'"><br>'];
                }
                var infoWindow = new AMap.InfoWindow({
                    content: "<font face=\"微软雅黑\"color=\"#3366FF\">" + clouddata._name + "</font><hr/>"+photo.join("")+"地址：" + clouddata._address + "<br />" + "创建时间：" + clouddata._createtime + "<br />" + "更新时间：" + clouddata._updatetime,
                    size: new AMap.Size(0, 0),
                    autoMove: true,
                    offset: new AMap.Pixel(0, -25)
                });

                infoWindow.open(map, clouddata._location);
            });
        });
    }
</script>
<%=include adminfooter_index.html%>
